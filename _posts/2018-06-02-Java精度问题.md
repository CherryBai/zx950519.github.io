---
layout:     post
title:      Java 精度问题总结
subtitle:   Java Double&BigDecimal猜坑记
date:       2018-06-02
author:     Alitria
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Java
    - 解题模板
    - 总结
    - BigDecimal
---

## 问题引入
&emsp;&emsp;丫的，前两天做题发现了这么个奇葩的问题，代码如下：  

```
public class Main {

    public static void main(String[] args) throws Exception {
        System.out.println(0.2 + 0.1);
        System.out.println(0.4 - 0.3);
        System.out.println(0.1 * 0.2);
        System.out.println(0.6 / 0.2);
        System.out.println(4.1 - 1.1);
    }
    //    0.30000000000000004
    //    0.10000000000000003
    //    0.020000000000000004
    //    2.9999999999999996
    //    2.9999999999999996

}
```  
&emsp;&emsp;尤其是最下面那组4.1-1.1，解题的一个步骤是要求两个数(double类型)差的绝对值，然后向下取整，我直接用Math.floor(Math.abs(4.1-1.1));
发现结果竟然等于2，后来经过网上搜集资料，发现Java在精度上是有问题的！  

## 理论解释  
&emsp;&emsp;借用《Effactive Java》书中的话，float和double类型的主要设计目标是为了科学计算和工程计算。他们执行二进制浮点运算，这是为了在广域数值范围上提供较为精确的快速近似计算而精心设计的。然而，它们没有提供完全精确的结果，所以不应该被用于要求精确结果的场合。但是，商业计算往往要求结果精确，这时候BigDecimal就派上大用场了。  
&emsp;&emsp;在学习计算机组成原理的时候我们应该都对浮点数有一定的了解，看下这个演示的例子就知道为啥会出现丢失精度的问题：https://www.zhihu.com/question/42024389

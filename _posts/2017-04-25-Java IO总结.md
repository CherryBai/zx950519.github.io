---
layout:     post
title:      I/O总结
subtitle:   Java的I/O学习总结
date:       2018-04-25
author:     Alitria
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - I/O
    - Java
    - 总结
---

## 说明
本文总结了一些与Java相关的I/O知识，包括普通I/O，NIO，AIO，BIO。

## I/O概述

Java中I/O操作主要是指使用Java进行输入，输出操作。Java所有的I/O机制都是基于数据流进行输入输出，
这些数据流表示了字符或者字节数据的流动序列。流是一组有顺序的，有起点和终点的字节集合，是对数据传输的总称或抽象。
即数据在两设备间的传输称为流，流的本质是数据传输，根据数据传输特性将流抽象为各种类，方便更直观的进行数据操作。

数据流分为两类：  
    -(1)字节流：数据流中最小的数据单元是字节。  
    -(2)字符流：数据流中最小的数据单元是字符，Java中的字符是Unicode编码，一个字符占用两个字节。
  
  
二者的区别：  
    (1)读写单位不同：字节流以字节(8bit)为单位,字符流以字符为单位，根据码表映射字符，一次可能读取多个字节。  
    (2)处理对象不同：字节流能处理所有类型的数据，字符流只能处理字符类的数据。  
    (3)处理纯文本数据，优先考虑使用字符流，除此之外优先考虑字节流。  
  
  
Java I/O的层次：  
![I/O体系图](http://i4.bvimg.com/643127/49ba5f5973972f34.png)  
    (1)流式部分——最主要的部分。如：OutputStream、InputStream、Writer、Reader等  
    (2)非流式部分——如：File类、RandomAccessFile类和FileDescriptor等类  
    (3)其他——文件读取部分的与安全相关的类，如：SerializablePermission类，以及与本地操作系统相关的文件系统的类，
    如：FileSystem类和Win32FileSystem类和WinNTFileSystem类。  
  
  
Java I/O主要使用的类：  
    (1)File（文件特征与管理：用于文件或者目录的描述信息，例如生成新目录，修改文件名，删除文件，判断文件所在路径  
    (2)InputStream（字节流，二进制格式操作）：抽象类，基于字节的输入操作，是所有输入流的父类。定义了所有输入流都具有的共同特征  
    (3)OutputStream（字节流，二进制格式操作）：抽象类。基于字节的输出操作。是所有输出流的父类。定义了所有输出流都具有的共同特征。  
    (4)Reader（字符流，文本格式操作）：抽象类，基于字符的输入操作。  
    (5)Writer（字符流，文本格式操作）：抽象类，基于字符的输出操作。  
    (6)RandomAccessFile（随机文件操作）：它的功能丰富，可以从文件的任意位置进行存取（输入输出）操作。


Java I/O流：  
Java.io包里有4个基本类：InputStream、OutputStream及Reader、Writer类，它们分别处理字节流和字符流。
其他各种各样的流都是由这4个派生出来的。
![Markdown](http://i4.bvimg.com/643127/6301688b07e7e4des.png)  

## RandomAccessFile的使用

## 源码分析

## I/O 实操
#### 创建一个新文件
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    try{
        f.createNewFile();
    }catch (Exception e) {
        e.printStackTrace();
    }
```
#### File类的两个常量
```
    // 分隔符 跨平台
    System.out.println(File.separator);
    System.out.println(File.pathSeparator);
```
#### 删除一个文件
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    if(f.exists()){
        f.delete();
    }else{
        System.out.println("文件不存在");
    }
```
#### 创建一个文件夹
```
    String fileName="D:"+File.separator+"hello";
    File f=new File(fileName);
    f.mkdir();
```
#### 列出指定目录的全部文件（包括隐藏文件）
```
    String fileName="D:"+File.separator;
    File f=new File(fileName);
    String[] str=f.list();
    for (int i = 0; i < str.length; i++) {
        System.out.println(str[i]);
    }
    或
    String fileName="D:"+File.separator;
    File f=new File(fileName);
    File[] str=f.listFiles();
    for (int i = 0; i < str.length; i++) {
        System.out.println(str[i]);
    }
```
#### 判断一个指定的路径是否为目录
```
    String fileName="D:"+File.separator;
    File f=new File(fileName);
    if(f.isDirectory()){
        System.out.println("YES");
     }else{
        System.out.println("NO");
     }
```
#### 搜索指定目录的全部内容
```
    String fileName="D:"+File.separator;
    File f=new File(fileName);
    print(f);
    
    public static void print(File f){
        if(f!=null){
            if(f.isDirectory()){
                File[] fileArray=f.listFiles();
                if(fileArray!=null){
                    for (int i = 0; i < fileArray.length; i++) {
                        //递归调用
                        print(fileArray[i]);
                    }
                }
            }
            else{
                System.out.println(f);
            }
        }
    }
```
#### 使用RandomAccessFile写入文件
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    RandomAccessFile demo=new RandomAccessFile(f,"rw");
    demo.writeBytes("asdsad");
    demo.writeInt(12);
    demo.writeBoolean(true);
    demo.writeChar('A');
    demo.writeFloat(1.21f);
    demo.writeDouble(12.123);
    demo.close();  
```
#### 字节流写入
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    OutputStream out =new FileOutputStream(f);
    String str="你好";
    byte[] b=str.getBytes();
    out.write(b);
    out.close();
    
    或
    
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    OutputStream out =new FileOutputStream(f);
    String str="你好";
    byte[] b=str.getBytes();
    for (int i = 0; i < b.length; i++) {
        out.write(b[i]);
    }
    out.close();
```
#### 字节流追加
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    OutputStream out =new FileOutputStream(f,true);
    String str="Rollen";
    //String str="\r\nRollen";  可以换行
    byte[] b=str.getBytes();
    for (int i = 0; i < b.length; i++) {
        out.write(b[i]);
    }
    out.close();
```
#### 字节流读取
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    InputStream in=new FileInputStream(f);
    byte[] b=new byte[(int)f.length()];
    int len=in.read(b);
    in.close();
    System.out.println("读入长度为："+len);
    System.out.println(new String(b,0,len));
    
    或
    
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    InputStream in=new FileInputStream(f);
    byte[] b=new byte[(int)f.length()];
    for (int i = 0; i < b.length; i++) {
        b[i]=(byte)in.read();
    }
    in.close();
    System.out.println(new String(b));
    
    当不知道文件有多大时按照下面这种方式读
    
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    InputStream in=new FileInputStream(f);
    byte[] b=new byte[1024];
    int count =0;
    int temp=0;
    while((temp=in.read())!=(-1)){
        b[count++]=(byte)temp;
    }
    in.close();
    System.out.println(new String(b));
```
#### 字符流写入
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    // 追加写：Writer out =new FileWriter(f, true);
    Writer out =new FileWriter(f);
    String str="hello";
    //  换行 out.write("\r\n");
    out.write(str);
    out.close();    
```
#### 字符流读入
```
    String fileName="D:"+File.separator+"hello.txt";
    File f=new File(fileName);
    char[] ch=new char[100];
    Reader read=new FileReader(f);
    int temp=0;
    int count=0;
    while((temp=read.read())!=(-1)){
        ch[count++]=(char)temp;
    }
    read.close();
    System.out.println("内容为"+new String(ch,0,count));
```

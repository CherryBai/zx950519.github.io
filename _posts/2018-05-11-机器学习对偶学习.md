---
layout:     post
title:      机器学习——对偶问题
subtitle:   线性规划+拉格朗日
date:       2018-05-11
author:     Alitria
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - ML
    - 对偶
    - 线性规划
    - 拉格朗日
---

## 对偶问题的描述
&emsp;&emsp;对偶问题是实质相同但从不同角度提出不同提法的一对问题。对于某一问题，采用对偶这一形式我们可以将其转化为另一同质问题并解决。

## 线性规划中的对偶问题
&emsp;&emsp;每个线性规划问题都有一个与之对应的对偶问题。对偶问题是以原问题的约束条件和目标函数为基础构造而来的。对偶问题也是一个线性规划问题，
因此可以采用单纯形法（有关单纯形法会在以后的笔记中补充）求解。对偶问题的最优解也可以通过原问题的最优解得到，反之亦然。而且，
在某些情况下，利用对偶理论求解线性规划问题更为简单，而且有助于深入了解待求问题的本质。  
  

&emsp;&emsp;线性规划中的对偶问题一般有三种：
- 对称形式的对偶
- 非对称形式的对偶
- 一般形式的对偶  

&emsp;&emsp;下面将会依次解释这三种情况：  

#### 对称形式的对偶
&emsp;&emsp;对称形式的对偶，一般限制条件会采用不等号。在转化为其对偶问题时，原优化目标由求最小变为求最大。其中A是m*n矩阵，b是m维列向量，
c是n维行向量，x是由原问题组成的n维列向量，w是由对偶问题的变量组成的m维行向量。具体的操作，看了下面的实例，相信你会懂的。  

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7m9xjeigj30rt11240d.jpg)

#### 非对称形式的对偶
&emsp;&emsp;对称形式的对偶，一般限制条件会采用等号。在上述对称形式的对偶中我们考虑的约束条件为不等式约束条件，这里我们对等式约束条件下的
对偶问题称为非对称形式的对偶。但是对偶问题的变换方式和上述类似，只需稍微的变换一下，如下所示。具体的操作，看了下面的实例，相信你会懂的。  

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7m9q0t10j30rt112767.jpg)

#### 一般形式的对偶
&emsp;&emsp;一般形式的对偶，是上面两种情况的结合。我们通过引入松弛变量将其转化为非对称形式的对偶然后求解。具体的操作，看了下面的实例，
相信你会懂的。  

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7m965satj30rt1120uj.jpg)

#### 对偶问题的基本定理

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7moh0t76j30v90f6myu.jpg)

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7molemztj30vc0fujtd.jpg)

## 拉格朗日定理+对偶问题
&emsp;&emsp;拉格朗日对偶性在很多优化问题上发挥了很重要的作用，机器学习中很多算法也都是通过拉格朗日对偶性来求解。接下来先来看看优化问题的几种分类：  

- 无约束条件优化问题
- 等式约束条件优化问题
- 不等式约束条件优化问题  

#### 无约束条件优化问题
&emsp;&emsp;例如函数f(x)=(x-1)*(x-1)-1在区间[-2, 4]上有最小值-1与最大值8。该问题并没有约束条件，而且是我们高中就能解决的优化问题。

#### 等式约束条件优化问题
&emsp;&emsp;例如求解表面积为a*a而提价最大的长方体体积(设其三条棱为x,y,z)。  

#### 不等式约束条件优化问题
&emsp;&emsp;线性规划问题！ 

#### 拉格朗日乘子法
&emsp;&emsp;作为使用的例子，我们将解决等式约束条件优化问题中的问题：  

![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7nfwx8maj30ku112jt7.jpg)  

&emsp;&emsp;一般来说，只有在等式约束的条件下：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7njztbg9j30v903a0st.jpg)
&emsp;&emsp;可以定义拉格朗日函数：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr7nk8my7mj30vb02rt8r.jpg)
&emsp;&emsp;然后对各个变量求偏导并令其偏导值为0，联立求解得最值。  

&emsp;&emsp;如何理解拉格朗日函数的实际意义呢，请看下图：  
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8b9bhay7j30vc092gmj.jpg)

&emsp;&emsp;其中，绿线标出的是约束g(x, y)=c的点的轨迹。蓝线是f(x, y)的等高线。箭头表示斜率，和等高线法线平行。从梯度方向上看，显然有
d1>d2。换言之，只有只有刚好落在这条绿线上的点才可能是满足要求的点。如果没有这条约束，f(x, y)的最小值应该会落在等高线内部的某一点上。加上
约束应该在f(x, y)的等高线和约束线相切的位置。如果二者仅仅相交，意味着还存在其他的等高线在该条等高线的内部或外部，使得新的等高线与目标函数
的焦点值更大或更小，只有到等高线与目标函数的曲线相切的时候，可能取得最优值。  

&emsp;&emsp;如果对约束也求梯度，其梯度如图中绿色箭头所示。要想让目标函数f(x, y)的等高线和约束相切，则他们切点的梯度一定在一条直线上(f和g
的斜率平行)。相切的性质意味着f和g的切线在某点平行，同时意味着两者的梯度平行。
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8bh6h66mj30v907imzz.jpg)

例子：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8bt8wy7nj30rt1123zz.jpg)

&emsp;&emsp;对于上面的例子，f(x, y)=x^2+y^2, 约束条件g(x, y)=x+y=1。我们可以观察到当f(x, y)=x^2+y^2其值为1或2时，二者均与g(x, y)相交，
说明其内部一定有一个更小的f(x, y)=x^2+y^2能与约束条件g(x, y)=x+y=1相切，这个值就是f(x, y)=x^2+y^2=1/2。而且在切点，二者梯度在同一条直
线上。

#### 广义拉格朗日函数
&emsp;&emsp;设f(x), ci(x), hj(x)是定义在Rn上面的连续可微函数，考虑约束最优化问题：  
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8c2g8ihsj30uy04y3yy.jpg)

&emsp;&emsp;我们可以引入广义拉格朗日函数：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8c3d89tyj30v2032glw.jpg)  

#### 原始问题和对偶问题
&emsp;&emsp;根据上图所引入的拉格朗日函数，我们将其称为原始问题(下标p表示原始问题)，并考虑x的函数：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8cbw2r4mj30ux02ndfw.jpg)  
&emsp;&emsp;再定义一个等式如下：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8ce3p1mij30uv039mxm.jpg)  
&emsp;&emsp;解释如下：先考虑x不满足约束条件的情况。当x不满足约束条件=>约束条件之一不成立，即存在某个i或j使得ci(x)>0或hj(x)!=0，我们规定当
ci(x)>0时αi取正无穷，当hj(x)!=0时，βjhj(x)取正无穷，则有：  
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8chju6r2j30uw035mxq.jpg)  
&emsp;&emsp;当满足约束条件ci(x)<=0或hj(x)=0时，也就是刚好都能取到0时，有：  
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8ckoctxij30ux031q33.jpg)
&emsp;&emsp;进而我们可推导出：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8coigy78j30v102laad.jpg)  
&emsp;&emsp;两个等号之间的形式通常被称为广义拉格朗日函数的极小极大问题。我们定义原始问题的最优值p*为：
![](http://ww1.sinaimg.cn/large/005L0VzSgy1fr8cs8d1umj30ux02n74h.jpg)

## SVM+对偶问题
&emsp;&emsp;在SVM中，可以使用拉格朗日对偶法来解决最大化间隔问题。为什么选择该方法呢？原因有下：  
- 不等式约束一直是优化问题中的难题，求解对偶问题可以将支持向量机原问题约束中的不等式约束转化为等式约束
- 支持向量机中用到了高维映射，但是映射函数的具体形式几乎完全不可确定，而求解对偶问题之后，可以使用核函数来解决这个问题  

&emsp;&emsp;值得注意的是，用拉格朗日对偶并没有改变最优解，而是改变了算法复杂度：在原问题下，求解算法的复杂度与样本维度（等于权值w的维度）有关；
而在对偶问题下，求解算法的复杂度与样本数量（等于拉格朗日算子a的数量）有关。
